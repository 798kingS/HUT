<Header title="æ ¡å›­äºŒæ‰‹ä¹¦"></Header>

<view class="books-container">
  <!-- æ¬¢è¿æ¨ªå¹… -->
  <view class="welcome-banner">
    <view class="banner-bg">
      <view class="banner-gradient"></view>
      <view class="banner-pattern"></view>
    </view>
    <view class="banner-content">
      <view class="welcome-text">
        <text class="greeting">ğŸ“š æ ¡å›­äºŒæ‰‹ä¹¦</text>
        <text class="subtitle">çŸ¥è¯†ä¼ æ‰¿ï¼Œç»¿è‰²ç¯ä¿</text>
      </view>
      <view class="books-stats">
        <text class="stats-number">{{booksList.length}}</text>
        <text class="stats-label">å¯ç”¨ä¹¦ç±</text>
      </view>
    </view>
  </view>

  <!-- æ™ºèƒ½æœç´¢ -->
  <view class="smart-search">
    <view class="search-wrapper">
      <view class="search-input {{searchFocus ? 'focus' : ''}}">
        <image src="/images/æœç´¢.png" class="search-icon"></image>
        <input class="input-field" placeholder="æœç´¢ä¹¦åæˆ–ä¸“ä¸š" value="{{searchKeyword}}" bindinput="onSearchInput" focus="{{searchFocus}}" bindfocus="onSearchFocus" bindblur="onSearchBlur" />
      </view>
      <button class="search-btn" bindtap="search">
        <text class="search-text">æœç´¢</text>
      </button>
    </view>
  </view>

  <!-- åˆ†ç±»ç­›é€‰ -->
  <view class="category-filters">
    <view class="filter-item {{currentFilter === 'all' ? 'active' : ''}}" bindtap="setFilter" data-filter="all">
      <image src="/images/å…¨éƒ¨.png" class="filter-icon"></image>
      <text class="filter-text">å…¨éƒ¨</text>
    </view>
    <view class="filter-item {{currentFilter === 'textbook' ? 'active' : ''}}" bindtap="setFilter" data-filter="textbook">
      <image src="/images/æ•™æ.png" class="filter-icon"></image>
      <text class="filter-text">æ•™æ</text>
    </view>
    <view class="filter-item {{currentFilter === 'novel' ? 'active' : ''}}" bindtap="setFilter" data-filter="novel">
      <image src="/images/å°è¯´.png" class="filter-icon"></image>
      <text class="filter-text">å°è¯´</text>
    </view>
    <view class="filter-item {{currentFilter === 'other' ? 'active' : ''}}" bindtap="setFilter" data-filter="other">
      <image src="/images/å…¶ä»–.png" class="filter-icon"></image>
      <text class="filter-text">å…¶ä»–</text>
    </view>
  </view>

  <!-- ä¹¦ç±åˆ—è¡¨ -->
  <view class="books-section">
    <view class="books-list">
      <view class="book-card" wx:for="{{booksList}}" wx:key="id" bindtap="viewDetail" data-item="{{item}}">
        <view class="card-header">
          <view class="book-cover-section">
            <image src="{{item.images}}" class="book-cover"></image>
            <view class="book-status">
              <text class="status-text">{{item.condition}}</text>
            </view>
          </view>
          <view class="book-info">
            <text class="book-title">{{item.title}}</text>
            <text class="book-author">{{item.author}}</text>
            <text class="book-publisher">{{item.publisher}}</text>
            <view class="book-tags">
              <text class="tag-item">{{item.major}}</text>
            </view>
          </view>
          <view class="price-section">
            <text class="price-symbol">Â¥</text>
            <text class="price-amount">{{item.price}}</text>
          </view>
        </view>
        
        <view class="book-description">
          <text class="desc-text">{{item.description}}</text>
        </view>
        
        <view class="seller-section">
          <view class="seller-info">
            <view class="seller-avatar">
              <image src="{{item.sellerAvatar}}" class="avatar-img"></image>
              <view class="online-indicator"></view>
            </view>
            <view class="seller-details">
              <text class="seller-name">{{item.sellerName}}</text>
              <text class="publish-time">{{item.publishTime}}</text>
            </view>
          </view>
          <view class="book-actions">
            <view class="action-btn" catchtap="likeBook" data-id="{{item.id}}">
              <text class="action-icon">ğŸ‘</text>
              <text class="action-count">{{item.likes || 0}}</text>
            </view>
            <view class="action-btn" catchtap="collectBook" data-id="{{item.id}}">
              <text class="action-icon">â­</text>
              <text class="action-count">{{item.collects || 0}}</text>
            </view>
            <view class="action-btn" catchtap="contactSeller" data-item="{{item}}">
              <text class="action-icon">ğŸ’¬</text>
              <text class="action-text">è”ç³»</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more-section" wx:if="{{hasMore}}">
      <button class="load-more-btn" bindtap="loadMore" loading="{{loading}}">
        <text class="load-text">{{loading ? 'åŠ è½½ä¸­...' : 'åŠ è½½æ›´å¤š'}}</text>
        <text class="load-icon">â†“</text>
      </button>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{booksList.length === 0 && !loading}}">
      <view class="empty-content">
        <text class="empty-icon">ğŸ“š</text>
        <text class="empty-title">æš‚æ— äºŒæ‰‹ä¹¦ä¿¡æ¯</text>
        <text class="empty-desc">å¿«æ¥å‘å¸ƒç¬¬ä¸€æœ¬äºŒæ‰‹ä¹¦ï¼Œè®©çŸ¥è¯†ä¼ æ‰¿ä¸‹å»</text>
        <button class="empty-action" bindtap="goToPublish">ç«‹å³å‘å¸ƒ</button>
      </view>
    </view>
  </view>
</view>

<!-- æ‚¬æµ®å‘å¸ƒæŒ‰é’® -->
<view class="fab-container">
  <button class="fab-button" bindtap="goToPublish">
    <text class="fab-icon">ğŸ“š</text>
    <text class="fab-text">å‘å¸ƒ</text>
  </button>
</view>