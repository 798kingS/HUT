<Header title="æ ¡å›­æ‹¼è½¦"></Header>

<view class="carpool-container">
  <!-- æ¬¢è¿æ¨ªå¹… -->
  <view class="welcome-banner">
    <view class="banner-bg">
      <view class="banner-gradient"></view>
      <view class="banner-pattern"></view>
    </view>
    <view class="banner-content">
      <view class="welcome-text">
        <text class="greeting">ğŸš— æ ¡å›­æ‹¼è½¦</text>
        <text class="subtitle">å®‰å…¨ã€ä¾¿æ·ã€ç»¿è‰²å‡ºè¡Œ</text>
      </view>
      <view class="carpool-stats">
        <text class="stats-number">{{carpoolList.length}}</text>
        <text class="stats-label">å¯ç”¨æ‹¼è½¦</text>
      </view>
    </view>
  </view>

  <!-- æ™ºèƒ½æœç´¢ -->
  <view class="smart-search">
    <view class="search-wrapper">
      <view class="search-input {{searchFocus ? 'focus' : ''}}">
        <image src="/images/æœç´¢.png" class="search-icon"></image>
        <input class="input-field" placeholder="æœç´¢å‡ºå‘åœ°æˆ–ç›®çš„åœ°" value="{{searchKeyword}}" bindinput="onSearchInput" focus="{{searchFocus}}" bindfocus="onSearchFocus" bindblur="onSearchBlur" />
      </view>
      <button class="search-btn" bindtap="search">
        <text class="search-text">æœç´¢</text>
      </button>
    </view>
  </view>

  <!-- æ—¶é—´ç­›é€‰ -->
  <view class="time-filters">
    <view class="filter-item {{currentFilter === 'all' ? 'active' : ''}}" bindtap="setFilter" data-filter="all">
      <image src="/images/å…¨éƒ¨.png" class="filter-icon"></image>
      <text class="filter-text">å…¨éƒ¨</text>
    </view>
    <view class="filter-item {{currentFilter === 'today' ? 'active' : ''}}" bindtap="setFilter" data-filter="today">
      <image src="/images/ä»Šå¤©.png" class="filter-icon"></image>
      <text class="filter-text">ä»Šå¤©</text>
    </view>
    <view class="filter-item {{currentFilter === 'tomorrow' ? 'active' : ''}}" bindtap="setFilter" data-filter="tomorrow">
      <image src="/images/æ˜å¤©.png" class="filter-icon"></image>
      <text class="filter-text">æ˜å¤©</text>
    </view>
    <view class="filter-item {{currentFilter === 'week' ? 'active' : ''}}" bindtap="setFilter" data-filter="week">
      <image src="/images/æœ¬å‘¨.png" class="filter-icon"></image>
      <text class="filter-text">æœ¬å‘¨</text>
    </view>
  </view>

  <!-- æ‹¼è½¦åˆ—è¡¨ -->
  <view class="carpool-section">
    <view class="carpool-list">
      <view class="carpool-card" wx:for="{{carpoolList}}" wx:key="id" bindtap="viewDetail" data-item="{{item}}">
        <view class="card-header">
          <view class="user-section">
            <view class="user-avatar">
              <image src="{{item.avatar}}" class="avatar-img"></image>
              <view class="online-indicator"></view>
            </view>
            <view class="user-info">
              <text class="username">{{item.username}}</text>
              <text class="post-time">{{item.time}}</text>
            </view>
          </view>
          <view class="price-badge">
            <text class="price-symbol">Â¥</text>
            <text class="price-amount">{{item.price}}</text>
          </view>
        </view>
        
        <view class="route-section">
          <view class="route-path">
            <view class="route-point departure">
              <view class="point-icon">ğŸŸ¢</view>
              <text class="point-label">{{item.departure}}</text>
            </view>
            <view class="route-line">
              <view class="line-dots">
                <view class="dot"></view>
                <view class="dot"></view>
                <view class="dot"></view>
              </view>
            </view>
            <view class="route-point destination">
              <view class="point-icon">ğŸ”´</view>
              <text class="point-label">{{item.destination}}</text>
            </view>
          </view>
          <view class="departure-time">
            <text class="time-icon">â°</text>
            <text class="time-text">{{item.departureTime}}</text>
          </view>
        </view>
        
        <view class="car-info-section">
          <view class="car-details">
            <view class="car-item">
              <text class="car-icon">ğŸš—</text>
              <text class="car-text">{{item.carType}}</text>
            </view>
            <view class="seats-item">
              <text class="seats-icon">ğŸ’º</text>
              <text class="seats-text">å‰©ä½™{{item.availableSeats}}åº§</text>
            </view>
          </view>
          <view class="card-actions">
            <view class="action-btn" catchtap="likeCarpool" data-id="{{item.id}}">
              <text class="action-icon">ğŸ‘</text>
              <text class="action-count">{{item.likes || 0}}</text>
            </view>
            <view class="action-btn" catchtap="collectCarpool" data-id="{{item.id}}">
              <text class="action-icon">â­</text>
              <text class="action-count">{{item.collects || 0}}</text>
            </view>
            <view class="action-btn" catchtap="shareCarpool" data-item="{{item}}">
              <text class="action-icon">ğŸ“¤</text>
              <text class="action-text">åˆ†äº«</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more-section" wx:if="{{hasMore}}">
      <button class="load-more-btn" bindtap="loadMore" loading="{{loading}}">
        <text class="load-text">{{loading ? 'åŠ è½½ä¸­...' : 'åŠ è½½æ›´å¤š'}}</text>
        <text class="load-icon">â†“</text>
      </button>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{carpoolList.length === 0 && !loading}}">
      <view class="empty-content">
        <text class="empty-icon">ğŸš—</text>
        <text class="empty-title">æš‚æ— æ‹¼è½¦ä¿¡æ¯</text>
        <text class="empty-desc">å¿«æ¥å‘å¸ƒç¬¬ä¸€ä¸ªæ‹¼è½¦ä¿¡æ¯ï¼Œè®©å‡ºè¡Œæ›´ä¾¿æ·</text>
        <button class="empty-action" bindtap="goToPublish">ç«‹å³å‘å¸ƒ</button>
      </view>
    </view>
  </view>
</view>

<!-- æ‚¬æµ®å‘å¸ƒæŒ‰é’® -->
<view class="fab-container">
  <button class="fab-button" bindtap="goToPublish">
    <text class="fab-icon">ğŸš—</text>
    <text class="fab-text">å‘å¸ƒ</text>
  </button>
</view> 